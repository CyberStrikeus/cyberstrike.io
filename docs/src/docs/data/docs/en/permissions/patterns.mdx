---
title: Permission Patterns
description: Define allow and deny patterns for fine-grained permission control
sidebar:
  order: 3
  label: Patterns
---

Permission patterns provide fine-grained control over which operations are allowed or denied.

{/* TODO: Screenshot - Permission pattern matching */}
<div className="border-2 border-dashed border-gray-400 dark:border-gray-600 rounded-lg p-8 my-6 text-center bg-gray-100 dark:bg-gray-800">
  <p className="text-gray-500 dark:text-gray-400 font-mono text-sm">ðŸ“¸ SCREENSHOT: permission-patterns.png</p>
  <p className="text-gray-400 dark:text-gray-500 text-xs mt-2">Permission pattern configuration</p>
</div>

## Pattern Syntax

### Basic Format

```
Tool(argument-pattern)
```

### Examples

```
Bash(npm test)           # Specific command
Write(*.md)              # File extension
Read(src/**/*)           # Directory glob
Edit(config.json)        # Specific file
```

## Tool Patterns

### Bash Patterns

```json
{
  "allow": [
    "Bash(npm *)",
    "Bash(git status)",
    "Bash(git log *)",
    "Bash(ls *)",
    "Bash(cat *)"
  ],
  "deny": [
    "Bash(rm -rf *)",
    "Bash(sudo *)",
    "Bash(dd *)",
    "Bash(mkfs *)"
  ]
}
```

### Write Patterns

```json
{
  "allow": [
    "Write(reports/**)",
    "Write(*.md)",
    "Write(src/**/*.ts)"
  ],
  "deny": [
    "Write(.env*)",
    "Write(*.pem)",
    "Write(~/.ssh/*)"
  ]
}
```

### Read Patterns

```json
{
  "allow": [
    "Read(**)"
  ],
  "deny": [
    "Read(~/.aws/credentials)",
    "Read(*.key)"
  ]
}
```

### Edit Patterns

```json
{
  "allow": [
    "Edit(src/**)",
    "Edit(tests/**)"
  ],
  "deny": [
    "Edit(package-lock.json)",
    "Edit(yarn.lock)"
  ]
}
```

## Glob Patterns

### Wildcards

| Pattern | Matches |
|---------|---------|
| `*` | Any characters except `/` |
| `**` | Any characters including `/` |
| `?` | Single character |
| `[abc]` | Character set |
| `[a-z]` | Character range |
| `{a,b}` | Alternatives |

### Examples

```
*.ts          â†’ file.ts, index.ts
**/*.ts       â†’ src/file.ts, deep/nested/file.ts
src/*         â†’ src/file (not src/dir/file)
src/**        â†’ src/file, src/dir/file, src/a/b/c
test?.ts      â†’ test1.ts, testA.ts
[abc].ts      â†’ a.ts, b.ts, c.ts
*.{ts,js}     â†’ file.ts, file.js
```

## Command Patterns

### Exact Match

```json
{
  "allow": [
    "Bash(npm test)",
    "Bash(npm run lint)"
  ]
}
```

### Prefix Match

```json
{
  "allow": [
    "Bash(npm *)",
    "Bash(git *)"
  ]
}
```

### Complex Commands

```json
{
  "allow": [
    "Bash(npm run *)",
    "Bash(docker build *)",
    "Bash(kubectl get *)"
  ]
}
```

### Piped Commands

```json
{
  "allow": [
    "Bash(cat * | grep *)",
    "Bash(ls * | head *)"
  ]
}
```

## File Path Patterns

### Relative Paths

```json
{
  "allow": [
    "Write(src/**)",
    "Write(tests/**)",
    "Write(docs/**)"
  ]
}
```

### Absolute Paths

```json
{
  "deny": [
    "Write(/etc/*)",
    "Write(/var/*)",
    "Read(/etc/shadow)"
  ]
}
```

### Home Directory

```json
{
  "deny": [
    "Write(~/.ssh/*)",
    "Write(~/.aws/*)",
    "Read(~/.gnupg/*)"
  ]
}
```

### Current Directory

```json
{
  "allow": [
    "Write(./**)"
  ],
  "deny": [
    "Write(../**)"
  ]
}
```

## Priority Rules

### Order of Evaluation

1. Explicit deny patterns (highest priority)
2. Explicit allow patterns
3. Default behavior (lowest priority)

### Example

```json
{
  "allow": [
    "Write(**)"
  ],
  "deny": [
    "Write(.env*)"
  ]
}
```

Result: All writes allowed except .env files.

### More Specific Wins

```json
{
  "allow": [
    "Write(config/*)"
  ],
  "deny": [
    "Write(config/secrets.json)"
  ]
}
```

Result: `config/secrets.json` is denied (more specific).

## Negation Patterns

### Exclude from Allow

```json
{
  "allow": [
    "Write(src/**)",
    "!Write(src/vendor/**)"
  ]
}
```

### Exclude from Deny

```json
{
  "deny": [
    "Bash(rm *)",
    "!Bash(rm node_modules)"
  ]
}
```

## Environment-Specific Patterns

### Development

```json
{
  "permissions": {
    "allow": [
      "Bash(*)",
      "Write(**)"
    ]
  }
}
```

### Production

```json
{
  "permissions": {
    "mode": "plan",
    "allow": [
      "Read(**)"
    ]
  }
}
```

### CI/CD

```json
{
  "permissions": {
    "mode": "auto",
    "allow": [
      "Bash(npm *)",
      "Bash(docker *)",
      "Write(reports/**)"
    ],
    "deny": [
      "Bash(rm -rf *)",
      "Write(.env*)"
    ]
  }
}
```

## Security Patterns

### Common Deny Patterns

```json
{
  "deny": [
    "Bash(rm -rf /)",
    "Bash(rm -rf ~)",
    "Bash(rm -rf /*)",
    "Bash(:(){ :|:& };:)",
    "Bash(dd if=/dev/zero *)",
    "Bash(mkfs *)",
    "Bash(chmod -R 777 *)",
    "Bash(curl * | bash)",
    "Bash(wget * | sh)",
    "Write(.env*)",
    "Write(*.pem)",
    "Write(*.key)",
    "Write(**/secrets/*)",
    "Write(**/credentials/*)",
    "Read(~/.ssh/id_*)",
    "Read(~/.aws/credentials)",
    "Read(/etc/shadow)"
  ]
}
```

### Security Testing Patterns

```json
{
  "allow": [
    "Bash(nmap *)",
    "Bash(nuclei *)",
    "Bash(sqlmap *)",
    "Bash(ffuf *)",
    "Bash(gobuster *)",
    "Write(reports/**)",
    "Write(findings/**)"
  ]
}
```

## Testing Patterns

### Verify Pattern

```bash
cyberstrike config test-pattern "Bash(npm test)"
```

### List Active Patterns

```bash
cyberstrike config get permissions.allow
cyberstrike config get permissions.deny
```

### Debug Pattern Matching

```bash
cyberstrike --debug
# Shows pattern matching decisions
```

## Common Configurations

### Web Development

```json
{
  "permissions": {
    "allow": [
      "Bash(npm *)",
      "Bash(yarn *)",
      "Bash(pnpm *)",
      "Write(src/**)",
      "Write(public/**)",
      "Edit(*.{ts,tsx,js,jsx,css,html})"
    ],
    "deny": [
      "Write(node_modules/**)"
    ]
  }
}
```

### Security Testing

```json
{
  "permissions": {
    "allow": [
      "Bash(nmap *)",
      "Bash(nuclei *)",
      "Bash(ffuf *)",
      "Bash(curl *)",
      "Write(reports/**)"
    ]
  }
}
```

### Documentation

```json
{
  "permissions": {
    "allow": [
      "Write(docs/**)",
      "Write(*.md)",
      "Edit(*.md)",
      "Bash(npm run docs:*)"
    ]
  }
}
```

<Aside variant="tip">
  Start with restrictive patterns and expand as needed. It's easier to allow more than recover from unintended changes.
</Aside>

## Related Documentation

- [Permission Modes](/docs/permissions/permission-modes) - Mode configuration
- [Permissions Overview](/docs/permissions) - Permission system
- [Automation](/docs/permissions/automation) - CI/CD patterns
